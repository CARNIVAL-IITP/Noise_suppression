###########################################################################################################
# Perceptual Constants needed by PMSQE
#
###########################################################################################################
###########################################################################################################
# 16 kHz parameters
###########################################################################################################
Sp_16k = 6.910853e-006
Sl_16k = 1.866055e-001
Nb_16k = 49
Nf_16k = 512

abs_thresh_power_16k = [
    51286152.00,  2454709.500,  70794.593750,
    4897.788574,  1174.897705,  389.045166,
    104.712860,   45.708820,    17.782795,
    9.772372,     4.897789,     3.090296,
    1.905461,     1.258925,     0.977237,
    0.724436,     0.562341,     0.457088,
    0.389045,     0.331131,     0.295121,
    0.269153,     0.257040,     0.251189,
    0.251189,     0.251189,     0.251189,
    0.263027,     0.288403,     0.309030,
    0.338844,     0.371535,     0.398107,
    0.436516,     0.467735,     0.489779,
    0.501187,     0.501187,     0.512861,
    0.524807,     0.524807,     0.524807,
    0.512861,     0.478630,     0.426580,
    0.371535,     0.363078,     0.416869,
    0.537032]

modified_zwicker_power_16k = [0.25520097857560436, 0.25520097857560436,
                              0.25520097857560436, 0.25520097857560436,
                              0.25168783742879913, 0.24806665731869609,
                              0.244767379124259, 0.24173800119368227,
                              0.23893798876066405, 0.23633516221479894,
                              0.23390360348392067, 0.23162209128929445,
                              0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                              0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                              0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                              0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                              0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                              0.23, 0.23]

width_of_band_bark_16k = [
    0.157344,     0.317994,     0.322441,     0.326934,     0.331474,
    0.336061,     0.340697,     0.345381,     0.350114,     0.354897,
    0.359729,     0.364611,     0.369544,     0.374529,     0.379565,
    0.384653,     0.389794,     0.394989,     0.400236,     0.405538,
    0.410894,     0.416306,     0.421773,     0.427297,     0.432877,
    0.438514,     0.444209,     0.449962,     0.455774,     0.461645,
    0.467577,     0.473569,     0.479621,     0.485736,     0.491912,
    0.498151,     0.504454,     0.510819,     0.517250,     0.523745,
    0.530308,     0.536934,     0.543629,     0.550390,     0.557220,
    0.564119,     0.571085,     0.578125,     0.585232]

###########################################################################################################
###########################################################################################################
# 8 kHz parameters
###########################################################################################################
Sp_8k = 2.764344e-5
Sl_8k = 1.866055e-1
Nb_8k = 42
Nf_8k = 256

abs_thresh_power_8k = [
    51286152,     2454709.500,  70794.593750,
    4897.788574,  1174.897705,  389.045166,
    104.712860,   45.708820,    17.782795,
    9.772372,     4.897789,     3.090296,
    1.905461,     1.258925,     0.977237,
    0.724436,     0.562341,     0.457088,
    0.389045,     0.331131,     0.295121,
    0.269153,     0.257040,     0.251189,
    0.251189,     0.251189,     0.251189,
    0.263027,     0.288403,     0.309030,
    0.338844,     0.371535,     0.398107,
    0.436516,     0.467735,     0.489779,
    0.501187,     0.501187,     0.512861,
    0.524807,     0.524807,     0.524807]

modified_zwicker_power_8k = [0.25520097857560436, 0.25520097857560436,
                             0.25520097857560436, 0.25520097857560436,
                             0.25168783742879913, 0.24806665731869609,
                             0.244767379124259, 0.24173800119368227,
                             0.23893798876066405, 0.23633516221479894,
                             0.23390360348392067, 0.23162209128929445,
                             0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                             0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                             0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                             0.23, 0.23, 0.23, 0.23, 0.23, 0.23, 0.23,
                             0.23, 0.23]

width_of_band_bark_8k = [
    0.157344,     0.317994,     0.322441,     0.326934,     0.331474,
    0.336061,     0.340697,     0.345381,     0.350114,     0.354897,
    0.359729,     0.364611,     0.369544,     0.374529,     0.379565,
    0.384653,     0.389794,     0.394989,     0.400236,     0.405538,
    0.410894,     0.416306,     0.421773,     0.427297,     0.432877,
    0.438514,     0.444209,     0.449962,     0.455774,     0.461645,
    0.467577,     0.473569,     0.479621,     0.485736,     0.491912,
    0.498151,     0.504454,     0.510819,     0.517250,     0.523745,
    0.530308,     0.536934]

###########################################################################################################
###########################################################################################################
# Common parameters
###########################################################################################################
# Pow computation in frequency domain must be corrected due to windowing in STFT
# Correction = (1/rms(window))^2
# Use the same as the one you use during FFT computation
# Here are some precomputed examples:
Pow_correc_factor_Rect = 1.0                    # Rectangular window
Pow_correc_factor_Hann = 2.666666666666754      # Hann window
Pow_correc_factor_SqHann = 2.0                  # Square root Hann window
Pow_correc_factor_Hamming = 2.51635879188799    # Hamming window
Pow_correc_factor_FlatTop = 5.70713295690759    # FlatTop window